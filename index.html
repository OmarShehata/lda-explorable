<!DOCTYPE html>
<html>
<head>
	<title>A Geometric Intuition for LDA</title>
	<link rel = "stylesheet" type = "text/css" href = "style.css" />
	<script src="lib/two.min.js"></script>
    <script src="lib/Tween.js"></script>
    <script src="lib/papaparse.min.js"></script>
    <script src="lib/numbers.min.js"></script>
    <script src="lib/numeric-1.2.6.min.js"></script>
    <script src="lib/threejs/three.js"></script>
    <script src="lib/threejs/OrbitControls.js"></script>
    <script src="src/ThreePlotting.js"></script>
    <script src="src/LDA.js"></script>
    <script src="src/main.js"></script>
</head>
<body>
<div class="article">
	<h1 class="centered-text">
		A Geometric Intuition for Linear Discriminant Analysis
	</h1>
	<p class="centered-text faded-text subtitle">
		Omar Shehata – St. Olaf College – 2018
	</p>
	<p class="centered-text faded-text">
		<i>(<span id="minutes_read"></span> min read)</i>
	</p>
	<!-- 
	Sources: https://sebastianraschka.com/Articles/2014_python_lda.html#%E2%80%93-bit-by-bit
	-->
	<p>Linear Discriminant Analysis, or LDA, is a useful technique in machine learning for <b>classification</b> and <b>dimensionality reduction</b> (also used in facial recognition? https://link.springer.com/article/10.1007%2Fs10115-006-0013-y ).</p>
	<p>The idea that you can take a rich 10 dimensional space and reduce it to 3 dimensions, while keeping most of the information intact, has always seemed a bit like magic to me. It's often used as a preprocessing step since a lot of algorithms perform better on a smaller number of dimensions. And of course, visualizing and reasoning about a 3 dimensional space is mucher easier than a higher dimensional one.</p> 
	<p>I like to think of LDA as a mathematical tool that allows you to peer into spaces that cannot be seen. It's like piercing the veil of the unknowable.</p>
	<p>This article will explore this statistical technique with a geometric approach. "Add geometry quote here". No background in machine learning is needed. </p>
	<!-- 
	- Add quote by William K CLifford abotu how geometric is the gate to science and so easy a child can go through it. 
	-->
	<hr>
	<h2>The Problem</h2>
	<p>You're given high dimensional data and you're trying to reduce it. This need not be anything esoteric. It could be data about houses on the market with price, age, size, distance to public transport and number of rooms. That's already 5 dimensions – too many to visualize all at once.</p>
	<p>Like any good mathematician, you can start with a simple approach and explore its consequences. What happens if you just drop one of the dimensions?</p>
	<p>Let's see what this looks like in a simple case. Here is some made up data about houses that's only in 2 dimensions. Blue dots could be houses that were sold and red ones are still looking for a buyer.</p>
	<div id="projection-2d" class="figure" ondragover="dragOverHandler(event);" ondragleave="dragLeaveHandler(event);" ondrop="dropHandler(event);"></div>
	<p>The graph on the left is the original data, and the line on the right is what it would look like after we drop it 1 dimension.</p>
	<p>We've succesfully reduced our data, but remember that our goal is to reduce it without losing information. In this case, you can easily tell that there is a pattern to the data when looking at the 2D view. This pattern is completely lost in the 1D view.</p>	
	<p>Another way to think about this is that if you were training an algorithm to predict whether houses would be sold using this as training data, it would perform much better using the original data than with the reduced version. This is bad because we wanted to transform this data to make our algorithms perform better, not worse!</p>
	<p>How can we do better? We dropped the Y axis above, so perhaps we could drop the X axis instead. You can see below how that still crushes the pattern. But notice that these aren't the only options. Geometrically, there are an infinite number of 1 dimensional lines that we could project down onto! </p>
	<p>Click and drag in the 2D graph below to rotate the projection line. </p> 
	<div id="projection-2d-2" class="figure" ondragover="dragOverHandler(event);" ondragleave="dragLeaveHandler(event);" ondrop="dropHandler(event);"></div>
	<p>Can you see how in some projections it's much easier to see the separation in 1D than in others? In fact, there is one particular line (which I used LDA to find), defined by the equation <span id="best-2d-projection" class="projection-link">y = 0</span> that produces the best possible separation for this data. <!-- If we were to then apply some classification algorithm, it would preform just as well on the reduced data as on the original, so we can throw away the high dimensional data and just work with the low dimensional! --></p>
	<p>We've certainly lost <i>some</i> information in that the reduced data only has one axis, but we haven't lost any important insights. In fact, we've actually gained some insight. The blue dots are all on one side and the red dots on the other. If you were given a new unclassified data point, it would be <i>easier</i> to predict whether it should be blue or red by looking at the 1D view. </p>
	<p>By removing information, we actually learned more about our data!</p>
	<h2>Higher Dimensions</h2>
	<p>To see how powerful this is, let's go one dimension up. Let's say you've got 3D data and you wanted to reduce it to 2D. The diagram below shows one such projection. </p>
	<p>If you're using a keyboard, you can rotate the projection plane with W/S, A/D and Q/E.</p>
	<div id="container-3d" ondragover="dragOverHandler(event);" ondragleave="dragLeaveHandler(event);" ondrop="dropHandler(event);">
		<canvas id="projection-3d" class="figure"></canvas>
		<div id="projection-3d-2d" class="figure"></div>
		<div style="clear:both"></div>
	</div>
	<p>It's already much harder. There's 3 degrees of motion for a plane in 3D as opposed to 1 for a line in 2D. The optimal here is the plane defined by <span id="best-3d-projection" class="projection-link">x + y + z = 0</span>. We need an algorithm so we can find the precise optimal, but also for situations where we can't even visualize the higher dimension. </p>
	<p>Here is 4 dimensional data projected down to two. There are 6 degrees of motion. What we want is just like above, to find the projection that gives us the best separation in a lower dimension.</p>
	<p><i>One 2D view, with 6 angles on top, of a rotating plane that projects 4D points into 2D.</i></p>
	<p>This one is much harder to do intuitively by hand. When our intuition fails, we look to mathematics to guide us.</p>
	<h2>The Algorithm</h2>
	<p>The exciting part of mathematics, for me, is figuring out how to take a real world problem like that and phrase it in a way that our mathematical tools can tackle.</p>
	<p>The first step is to recognize this as an optimization problem. We know it's an optimization problem because there exists a set of options, all one dimensional lines in the 2D case, and we're trying to find the best one.</p>
	<p>But how do we know which one is the "best" ? We know intuitively because it gives us the best separation. So far we've been doing this visually. We need to precisely articulate this definition to solve it as an optimization problem. </p>
	<p>This is really the fun part of mathematics. The rest is just details, implementation the solution. What sort of metric can you come up with that would give you a high number for these cases:</p>
	<p><i>Show 2D and 1D projections with good separation</i></p>
	<p>Compared to these cases</p>
	<p><i>Show 2D and 1D projections with BAD separation</i></p>
	<p>As a simple example of a metric, you could say it's the absolute distance between the means of the two classes. That would certainly work above, but not when the data is so spread out:</p>
	<p><i>Show 2D and 1D projections with very high variance</i></p>
	<p>Pretend like it's the 1930's and this hasn't been solved yet. Give it some thought, what would you come up with?</p>
	<hr>
	<p>If you came up with a solution that took into account both the means and the variance (spread), then give yourself a pat on the back. This is exactly what Ronald Fisher came up with 1936.</p>
	<!--  Add something about Fisher's personality? How not to be wrong made it fun -->
	<p>The exact formula he came up with is:</p>
	<p>(U_1 - U_2)^2 / S_1 + S_2</p>
	<p>Where S_i is the scatter. It's a measure of how spread out the data is. So we want to maximize this function, which means we want the biggest distance between the means, but also the smallest scatter.</p>
	<p>To see how it works, it always helps to see an example. Here's the function computed for a particular example. Move it to see how it changes for different projections.</p>
	<p><i>Put formula next to 2D example projected down.</i></p>
	<p>You can see how this (LINK) produces bad separation, and is thus a low number, an this (LINK) produces good separation and is thus a higher number.</p>
	<p>Notice that both cases there actually have the same mean distances to each other, which is why it's not sufficient just to use that as a metric. </p>
	<p>Now this isn't the only way to do it, and I encourage you to test out any different methods you came up with. That is the joy of maths. If you come up with something, publish it! </p>
	<h2>Implementation Details</h2>
	<p>Actually optimizing this is a matter of a little bit of calculus and a little bit of linear algebra. I won't go into the derivation here but (http://courses.cs.tamu.edu/rgutier/csce666_f13/l10.pdf) is a good resource. It does generalize to more than 2.</p>
	<p>Most statistical packages will have an implementation. Let's see if using LDA will give us the same answer to what the best projection is for the 2D case that we found by hand.</p>
	<p>In Python, you can do it like this</p>
	<p><i>Python example with data hardcoded in.</i></p>
	<p>You can run this online on Google's Colaboratory (https://colab.research.google.com). The result you'll get is X. Here's how to use it to find the projection. Does that seem true if you try it in the diagram?</p>
	<p>Now is the real power. We can just as easily apply this onto the 4th dimensional example. Show some code, show the result. </p>
	<p>And there it is. A beautiful hidden structure, buried in esoteric 4 dimensional space, previous unseeable, laid bare before our eyes.</p>
	<p>Those are the leaps we make with mathematics. That is the power and joy.</p>
	<hr>
	<div id="credit">
		<p>Thanks to Professor Matt Richey for his amazing and inspiring lectures in the Algorithms for Decision Making class.</p>
		<p>The source code for this page and all interactive diagrams is available on <a href="https://github.com/OmarShehata/lda-explorable">GitHub</a> and is public domain. I've set it up so it would be really easy to replace the sample data I have and re-run the diagrams with your own data. In fact, you can just drag and drop any .csv file with the right number of columns onto a diagram and it'll use the new column names and data. Hopefully you'll find this a useful tool in the classroom. </p>
	</div>
</div>
<script type="text/javascript">
	// Compute how many minutes to read 
	var wordCount = document.querySelector(".article").textContent.split(" ").length;
	var minutes = Math.round(wordCount / 200);
	document.querySelector("#minutes_read").innerHTML = String(minutes);
</script>
</body>
</html>